Всего страниц: 26

=== СТРАНИЦА 1 ===
Итоговый проект
Анализ сайта
«СберАвтоподписка»
Введение в Data Science

=== СТРАНИЦА 2 ===
Содержание
О компании «СберАвтоподписка» 3
О продукте 6
10
Что нужно сделать
11
Глоссарий
12
План работы
Формат решения 15
16
Презентация итоговой работы
Критерии оценки 18
Описание данных 21
Полезные материалы для выполнения проекта 23
2

=== СТРАНИЦА 3 ===
Поздравляем вас, вы дошли до финальной темы нашего
курса!
В рамках этого итогового проекта вы продемонстрируете свои знания 
и навыки для решения реальной задачи от нашего
партнёра — «СберАвтоподписки».
Реальные задачи не похожи на учебные из-за того, что в них нет простых
правильных ответов. Вы станете профессионалом только тогда, когда
сможете научиться использовать учебные и модельные подходы к решению
реальных задач с ошибками в данных, неоднозначных проблем и находить
непростые решения.
О компании «СберАвтоподписка»
«СберАвтоподписка» — это сервис долгосрочной аренды автомобилей для
физлиц.
Клиент платит фиксированный ежемесячный платёж и получает
в пользование машину на срок от шести месяцев до трёх лет. Также в платёж
включены:
страхование (КАСКО, ОСАГО, ДСАГО);
техническое обслуживание и ремонт;
сезонная смена шин и их хранение;
круглосуточная служба поддержки.
За дополнительную сумму можно приобрести услугу консьерж-сервиса —
доставку автомобиля до сервисного центра и обратно на техническое
обслуживание, сезонную замену шин, ремонт.
Один год исполнился «СберАвтоподписке» 24 мая 2022 года.
3

=== СТРАНИЦА 4 ===
«СберАвтоподписка» предлагает новый для российского рынка способ
владения автомобилем и выступает в качестве альтернативы автокредиту.
Машина — это актив, который быстро теряет в цене, поэтому мы
рекомендуем вкладывать собственные средства в финансовые инструменты,
а автомобиль брать во временное пользование за комфортную сумму
в месяц. Кроме этого, «Автоподписка» обладает преимуществами перед
покупкой машины в кредит и использованием каршеринга:
«СберАвтоподписка» Покупка машины Кредит Каршеринг
Нет крупного первого
+ — +
платежа
Ежемесячный платёж Сравним с кредитом + Оплата за время
на срок от пяти лет поездки
Не надо платить
+ — +
за страхование
и обслуживание
Постоянная + + —
доступность
Индивидуальное
+ + —
использование
Гарантированная
+ — —
исправность машины
Отсутствие
+ + —
промонаклеек
Подробнее об отличиях подписки от каршеринга по здесь.
4

=== СТРАНИЦА 5 ===
За год работы нам удалось доказать востребованность
сервиса. Более 1600 довольных клиентов и более 1700
автомобилей в подписку — некоторые клиенты взяли
в пользование более одного автомобиля. Эти цифры —
лучшее подтверждение того, что подписка — не просто дань
моде.
Несмотря на то, что последние годы были трудными для
автобизнеса, нам удалось предоставить клиентам выгодные
условия. Сейчас мы видим рост интереса к услуге подписки.
Многие не готовы к покупке автомобиля по новым ценам,
ожидая их снижения в будущем, и выбирают наш продукт как
доступную альтернативу владения.
Никита Чернов, коммерческий директор сервиса
«СберАвтоподписка»
5

=== СТРАНИЦА 6 ===
О продукте
В каталоге сервиса представлены более 20 моделей в наличии. Также сервис
практикует покупку машины под конкретного пользователя для тех, кто готов
взять автомобиль в подписку, но не нашёл на сайте интересующий вариант.
Чтобы оформить подписку, необходимо кликнуть по понравившемуся
автомобилю и выбрать:
срок аренды: от шести месяцев до трёх лет;
пакет пробега: лимит по количеству пройденных километров.
6

=== СТРАНИЦА 7 ===
После клика по кнопке «Оформить подписку» нужно оставить свои
контактные данные.
7

=== СТРАНИЦА 8 ===
На сайте пользователь совершает целевые действия. Например,
нажимает кнопки типа «Оставить заявку», «Заказать звонок».
Или нецелевые действия, например, просмотр карточек авто или
«блуждания» по основной странице и страницам с помощью.
Когда заявка оставлена, с пользователем связывается менеджер для
подбора оптимального варианта подписки. Клиент предоставляет документы
и «СберАвтоподписка» проводит скоринг, в результате чего принимает
решение, готовы ли мы выдать клиенту автомобиль в подписку. После
успешного скоринга подбор автомобиля продолжается, в том числе возможен
вариант покупки конкретного автомобиля специально под клиента. После
оплаты счёта клиент получает автомобиль в подписку: его можно забрать
в Москве, а также возможна доставка автомобиля в другие города России.
После оформления подписки пользователь взаимодействует
со «СберАвтоподпиской» по телефону и с помощью электронной почты.
Ссылки на оплату услуги приходят по почте и SMS.
8

=== СТРАНИЦА 9 ===
История проекта
Александр Тимаков
Руководитель отдела анализа данных
Привет! Мы — команда аналитики „СберАвтоподписки“.
Через наши руки проходит множество разных данных,
большая их часть — из различных внутренних систем
и с нашего веб-сайта. Мы стараемся собирать многие
события с сайта, чтобы извлекать полезные инсайты
и на их основе проводить работу, которая помогает
нашему бизнесу.
Недавно к нам пришла продуктовая команда и начала
задавать вопросы про веб-сайт и поведение
пользователей на нём. Они хотят понять, из каких
источников к нам идёт самый полезный трафик, какие
авто пользуются наибольшим спросом, с каких
устройств чаще всего заходят на сайт, какие действия
и формулировки вызывают наибольший отклик —
и массу других вещей.
Вам нужно будет разобраться в данных, поступающих
с веб-сайта, и помочь продуктовой команде ответить
на ряд вопросов — как на общие (о характеристике
пользователей и общей статистике по посещаемости),
так и на более комплексные (о тестировании гипотез,
разработке предиктивных моделей и разработке
пайплайнов обработки данных).
9

=== СТРАНИЦА 10 ===
Что нужно сделать
Итак, ваша задача — изучить предоставленный датасет, ответить на вопросы
из общей части (подразумевающей базовую обработку данных и их
разведочный анализ) и выполнить задание по специализации, в которой вы
хотели бы развиваться в будущем.
Шаги по каждому пункту и вопросы будут дальше, в разделе «План работы».
В итоговом проекте представлены задачи для трёх специализаций.
Дата аналитик:
1
Разбирается в математической статистике, умеет формулировать
и исследовать гипотезы. Владеет инструментами Business Intelligence,
которые помогают исследовать данные и переводить информацию, которая
в них содержится, на язык бизнеса, понятный людям, которые принимают 
то или иное управленческое решение.
ML-инженер:
2
Анализирует и готовит данные, затем тренирует на них модели машинного
обучения. Кроме того, он участвует в их внедрении в реальные процессы,
оборачивает в промышленный код, а также обеспечивает их стабильность 
и качество.
Дата-инженер:
3
Программист, который разбирается в специфике сбора, хранения 
и обработки больших и не очень данных. Он знает, как правильно собрать 
и куда положить данные для различных задач. Кроме того, он внедряет
сервисы, которые разрабатывают ML-инженеры, ставит их на мониторинг, 
а именно: следит за тем, чтобы они правильно работали в любой момент
времени.
10

=== СТРАНИЦА 11 ===
Глоссарий
Целевое действие — события типа «Оставить заявку» и «Заказать звонок»
(ga_hits.event_action in ['sub_car_claim_click', 'sub_car_claim_submit_click',
'sub_open_dialog_click', 'sub_custom_question_submit_click',
'sub_call_number_click', 'sub_callback_submit_click', 'sub_submit_success',
'sub_car_request_submit_click']).
CR (Conversion Rate) — показатель конверсии из визита (уникальный
session_id) в любое целевое действие в рамках одного визита (в случае
наличия >1 целевого действия — считать все как одно).
Органический трафик — все визиты с ga_sessions.utm_medium in ('organic',
'referral', '(none)').
Платный трафик — весь неорганический трафик.
Информация про марку и модель авто — содержится
в ga_hits.hit_page_path.
Реклама в социальных сетях — все визиты с ga_sessions.utm_source in
('QxAxdyPLuQMEcrdZWdWb', 'MvfHsxITijuriZxsqZqt', 'ISrKoXQCxqqYvAZICvjs',
'IZEXUFLARCUMynmHNBGo', 'PlbkrSYoHuZBWfYjYnfw',
'gVRrcxiDQubJiljoTbGm').
11

=== СТРАНИЦА 12 ===
План работы
Проведите подготовительную работу (1 час):
Прочитайте предоставленный датасет.
Ознакомьтесь с описаниями представленных атрибутов.
Оцените полноту и чистоту данных. Попытайтесь понять, что стоит
за этими данными в реальном мире. Приведите данные в удобный /
нормальный вид для дальнейшей работы.
Проведите разведочный анализ данных (4 часа):
Проведите базовую чистку (дубликаты, пустые значения, типизация
данных, ненужные атрибуты).
Посмотрите на распределение ключевых атрибутов, их отношения.
Выполните задание согласно вашей специализации
(18 часов):
12

=== СТРАНИЦА 13 ===
DA:
Проведите проверку следующих гипотез:
Органический трафик не отличается от платного с точки зрения CR
(Conversion Rate) в целевые события.
Трафик с мобильных устройств не отличается от трафика 
с десктопных устройств с точки зрения CR (Conversion Rate)
в целевые события.
Трафик из городов присутствия (Москва и область, Санкт-Петербург)
не отличается от трафика из иных регионов с точки зрения CR
(Conversion Rate) в целевые события.
Дайте ответы на вопросы продуктовой команды:
Из каких источников / кампаний / устройств / локаций к нам идёт
самый целевой трафик (и с точки зрения объёма трафика, и с точки
зрения CR)?
Какие авто пользуются наибольшим спросом? У каких авто самый
лучший показатель CR (Conversion Rate) в целевые события?
Стоит ли нам увеличивать своё присутствие в соцсетях и давать там
больше рекламы?
13

=== СТРАНИЦА 14 ===
ML:
Научитесь предсказывать совершение целевого действия
(ориентировочное значение ROC-AUC ~ 0.65) — факт совершения
пользователем целевого действия.
Упакуйте получившуюся модель в сервис, который будет брать на
вход все атрибуты, типа utm_*, device_*, geo_*, и отдавать на выход
0/1 (1 — если пользователь совершит любое целевое действие).
DE:
Настройте и запустите локальную БД, подходящую для хранения
и исполнения запросов к данным в предоставленном датасете.
Создайте объекты в БД для хранения данных исходного файла.
Обработайте и поместите в БД данные из предоставленного
основного датасета.
Настройте пайплайн сбора, обработки и записи в БД новых .json-
файлов.
Подготовьте получившиеся артефакты, проверьте их
на соответствие итоговым критериям оценки и сдайте их
(2 часа).
14

=== СТРАНИЦА 15 ===
Формат решения
Общее:
1
Формат файла — Jupyter Notebook
Содержание — код для чтения, обработки и EDA; получившиеся графики
и текстовые комментарии, а также выводы по данным.
DA:
2
Формат файла — Jupyter Notebook.
Содержание — результаты проверки гипотез в формате «Гипотеза —
Статистические критерий и тест — Результат теста — Текстовая
интерпретация результата».
ML:
3
Формат файла — (минимум) .py-скрипт с инструкцией по локальному
запуску или (максимум) localhost web app.
Содержание — модель, берущая на вход строку с данными по визиту
(согласно схеме данных) и отдающая на выход результат предсказания
по отдельному событию в числовом формате 0|1.
DE:
4
Формат файла — (минимум) .py-скрипт с DAG’ами и DDL-скриптами
или (максимум) работающий пайплайн в localhost Airflow и созданные
объекты в localhost SQL DB.
Содержание — пайплайн, на вход берущий новые json-файлы
и успешно добавляющий их в существующие таблицы.
15

=== СТРАНИЦА 16 ===
Презентация итоговой работы
Кроме выполнения проекта, вам предстоит также презентовать работу перед
экспертной комиссией. Чтобы это сделать, отправьте проект на проверку
и запишитесь на презентацию в курсе «Презентация итоговых проектов».
Презентация проекта проходит в онлайн-формате. 15 минут на презентацию
проекта и пять-десять минут на вопросы. Выступление должно состоять
из следующих частей:
Заглавный слайд с вашим именем и темой работы.
1
Описание проблемы, которая перед вами стояла.
2
Презентация общей части — разведочного анализа данных:
3
структура данных и особенности в данных;
выводы из данных;
необходимые проведённые преобразования над данными.
Презентация по специализациям:
4
DA:
проверка гипотез (методы проверки, полученные результаты);
развёрнутые ответы на вопросы «продуктовой команды»,
подкреплённые выводами из данных.
DE:
демонстрация развёрнутой БД с её структурой;
демонстрация работы пайплайна по перекладке json-файлов в Airflow.
16

=== СТРАНИЦА 17 ===
ML:
результаты фича-инжиниринга;
результаты подбора модели (какие алгоритмы были использованы,
их качество, как выбиралась наилучшая модель);
влияние использованных фичей на предсказательную способность
модели (feature importance);
демонстрация работы API.
Презентация сопровождается слайдами, подготовленными в Google Slides,
а также демонстрацией рабочего проекта в онлайн-режиме.
Ваши расчёты должны быть подтверждены файлом требуемого формата
и вместе с презентацией предоставлены до презентации куратору
на проверку.
По итогам презентации вы получите сертификат о прохождении курса.
17

=== СТРАНИЦА 18 ===
Критерии оценки
Общая часть
EDA:
Корректная обработка данных: выброшены пустые атрибуты, убраны
дубликаты, обработаны NaN-значения, таблицы сцеплены корректно.
Наличие релевантных визуализаций — подразумевается наличие
визуализаций распределений (histogram / boxplot), опционально —
динамика визитов и событий во времени
Нахождение основных корреляций (heatmap + выводы по полученным
связям).
Специализации
DA:
Проверка гипотез. Для каждой гипотезы:
1
Корректность выбранного метода.
Корректность выбранных параметров теста (мощность и прочее).
Корректность реализации теста на Python.
Ответы на вопросы бизнеса (оценка отраслевого эксперта):
2
Основанность на данных — ответы являются фактически корректными и
не содержат утверждений, противоречащих предоставленным данным.
Business Acumen — ответы демонстрируют понимание основ
маркетинговой аналитики и/или автомобильного рынка.
Интерпретируемость — ответ даёт однозначное решение поставленного
вопроса и не требует дополнительной трактовки или расширенного
комментария
18

=== СТРАНИЦА 19 ===
ML:
Значение ошибки на тестовой выборке (сравнение с бейслайном
1
по идентичной метрике качества).
Подход к работе с фичами:
2
Оценка проделанной работы с проработкой фичей: есть ли инжиниринг
новых фичей? релевантны ли применяемые для инжиниринга методы?
насколько линейно зависимы итоговые фичи друг от друга?
Насколько интерпретируемыми являются итоговые фичи в модели: можно
ли описать их суть понятным языком для человека, которому нужно будет
корректировать параметры рекламных кампаний?
Насколько итоговые фичи значимы для результата с точки зрения
оказываемого фичей вклада на итоговое значение предсказываемого
целевого действия?
Выбор модели (релевантность для решения поставленной задачи).
3
Реализация API:
4
Масштабируемость.
Корректность и скорость работы (среднее время от отправки запроса
в API до получения ответа клиентом не превышает трёх секунд).
DE:
Корректность создания объектов в БД:
1
Корректная типизация данных.
Настройка первичных и внешних ключей.
19

=== СТРАНИЦА 20 ===
Корректность добавления новых данных в БД:
2
Обработка и типизация новых данных.
Имеется механизм разрешения конфликтов при записи.
Реализация Airflow-пайплайна:
3
Наличие и корректность всех зависимостей между DAG’ами / task’ами
Качество реализации (чистота кода, идемпотентность, использование
переменных, наличие обращений в БД вне task’ов).
20

=== СТРАНИЦА 21 ===
Описание данных
Данные из Google Analytics (last-click attribution model) по сайту
«СберАвтоподписка».
GA Sessions (ga_sessions.pkl)
1
Одна строка = один визит на сайт.
Описание атрибутов:
session_id — ID визита;
client_id — ID посетителя;
visit_date — дата визита;
visit_time — время визита;
visit_number — порядковый номер визита клиента;
utm_source — канал привлечения;
utm_medium — тип привлечения;
utm_campaign — рекламная кампания;
utm_keyword — ключевое слово;
device_category — тип устройства;
device_os — ОС устройства;
device_brand — марка устройства;
device_model — модель устройства;
device_screen_resolution — разрешение экрана;
21

=== СТРАНИЦА 22 ===
device_brand — марка устройства;
device_model — модель устройства;
device_screen_resolution — разрешение экрана;
device_browser — браузер;
geo_country — страна;
geo_city — город.
GA Hits (ga_hits.pkl)
1
Одна строка = одно событие в рамках одного визита на сайт.
Описание атрибутов:
session_id — ID визита;
hit_date — дата события;
hit_time — время события;
hit_number — порядковый номер события в рамках сессии;
hit_type — тип события;
hit_referer — источник события;
hit_page_path — страница события;
event_category — тип действия;
event_action — действие;
event_label — тег действия;
event_value — значение результата действия.
22

=== СТРАНИЦА 23 ===
Полезные материалы для выполнения
проекта. ROC-AUC
Вспомните матрицу ошибок в Python. В ней есть четыре элемента:
TN (True Negative) — элементы, верно классифицированные как класс 0.
TP (True Positive) — элементы, верно классифицированные как класс 1.
FN (False Negative) — элементы, неверно классифицированные как класс
0.
FP (False Positive) — элементы, неверно классифицированные как класс
1.
Введём новые понятия:
TPR (True positive rate) — доля верно предсказанных классов у объектов,
относящихся к положительному классу.
23

=== СТРАНИЦА 24 ===
FPR (False positive Rate) — доля неправильно предсказанных классов
среди объектов отрицательного класса.
ROC-кривая (Receiver operating Characteristic) — кривая, которая
описывает взаимосвязь между чувствительностью модели (TPR — доля
истинно положительных примеров) и её специфичностью (описываемой
в отношении долей ложноположительных результатов — 1-FPR).
Предположим, у вас есть модель логистической регрессии, которая решает
некоторую задачу бинарной классификации. При этом она предсказывает
не только 0 и 1, но и может предсказывать вероятности отношения к классу 
0 и к классу 1 с помощью метода predict_proba.
Пусть эта модель предсказала четыре вероятности отношения объекта
к классу 1 (колонка predict_proba). Если мы возьмём стандартный порог,
равный 0.5, то в результате предикта мы получим классы из колонки 2. Если
же попробуем варьировать порог и выберем его равным 0.9, то получим
значения из последней колонки.
true_class predict_proba (class 1) predict (trsh=0.5) predict (trsh=0.9)
1 0.8 1 0
0 0.51 1 0
1 0.92 1 1
0 0.23 0 0
24

=== СТРАНИЦА 25 ===
Тогда при trsh=0.5 TPR будет равен 2/(2+0) = 1, а FPR=1/(1+1)= ½.
При trsh=0.9 TPR будет равен 1/(1+1) = 1/2, а FPR=0.
ROC-кривая — это зависимость TPR от FPR. Таким образом, мы получили
две точки для ROC-кривой: (½, 1) и (0, ½). Кривая начинается в начале
координат и стремится к (1,1). Чем больше значений трешхолда мы
исследуем, тем детальнее получается кривая.
Пример ROC-кривой:
ROC-AUC (AUC = area under the curve) — одна из метрик оценки качества
бинарной классификации.
Чтобы оценить, насколько хорош классификатор, рассчитывают площадь под
ROC-кривой. Значение, равное единице — это идеальный классификатор.
Значение 0.5 — рандомный классификатор.
То есть идеальная модель та, в которой доля TPR максимально высока,
а доля FPR удерживается как можно ниже.
25

=== СТРАНИЦА 26 ===
Roc curve
1.0
Perfect classifier
0.8 Better
0.6
0.4
0.2
0.0
1.0
0.0 0.2 0.4 0.6 0.8
False positive rate
26
etar
evitisop
eurT
er
sifi
s
a
cl
m
o
d
n a
R
Значение метрики ROC-AUC вы сможете посчитать с помощью функции
в sklearn, передав на вход истинные значения классов и вероятности
предсказания модели.
